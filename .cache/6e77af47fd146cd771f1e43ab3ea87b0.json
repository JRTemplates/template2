{"dependencies":[{"name":"stateman","loc":{"line":7,"column":23}},{"name":"./config","loc":{"line":8,"column":23}},{"name":"regularjs","loc":{"line":9,"column":22}}],"generated":{"js":"\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/**\n * 前端单页路由，基于hash\n * api:http://leeluolee.github.io/stateman/?API-zh=undefined&doc=API&lang=zh\n */\nvar stateman = require(\"stateman\");\nvar config_1 = require(\"./config\");\nvar Regular = require(\"regularjs\");\nexports.default = {\n    template: \"<jr-sidebar uniqueOpened={uniqueOpened} showRetract={false} top={ '15px'} menus={menus} ref='slider' />\",\n    config: function () {\n        this.data.menus = config_1.default.menulist;\n        this.routerObj = {};\n        this.createRoute(config_1.default.menulist);\n        this.stateMan.state(this.routerObj).start();\n    },\n    init: function () {\n        var hash = window.location.hash;\n        hash = hash.length > 0 ? hash.substr(1) : hash;\n        if (hash.indexOf('?') !== -1) {\n            hash = hash.substr(0, hash.indexOf('?'));\n        }\n        if (!this.routerObj[hash]) {\n            window.location.href = '#' + this.m;\n        }\n        this.supr();\n        this.$inject(\"#menu\");\n        this.$update();\n    },\n    currentModule: null,\n    stateMan: null,\n    /**\n     * 创建路由\n     */\n    createRoute: function (list) {\n        var _this = this;\n        this.stateMan = new stateman();\n        list.forEach(function (item) {\n            if (item.children) {\n                _this.createRoute(item.children);\n                return;\n            }\n            var m = item.url.slice(1);\n            if (item.currentSelected) {\n                _this.m = m;\n            }\n            _this.routerObj[m] = {\n                enter: function () {\n                    if (!item.module) {\n                        return;\n                    }\n                    var Module = Regular.extend(item.module.default);\n                    _this.currentModule = new Module();\n                    _this.changeView(item);\n                },\n                leave: function () {\n                    if (_this.currentModule) {\n                        _this.currentModule.$inject(false);\n                        _this.currentModule.destroy();\n                    }\n                },\n                update: function () {\n                    console.log(\"update the view: \" + m);\n                }\n            };\n        });\n    },\n    // 更改内容\n    changeView: function (item) {\n        var _this = this;\n        this.currentModule.$inject('#main');\n        window.setTimeout(function () {\n            _this.$refs.slider && _this.$refs.slider.selecteItem(item.url);\n            _this.$update();\n        }, 0);\n    }\n};\n//# sourceMappingURL=index.js.map"},"hash":"b4fd522c5e0ebf293a3b361acf6b4f11"}